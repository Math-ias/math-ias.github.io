<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Apple macOS version 5.8.0">
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="data:,">
  <title>AOC Day 1 2021</title>
  <style type="text/css">
  body {
    font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
  }

  /* General style. */
  .content {
    box-sizing: border-box;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .content > * {
    margin-top: 20px;
    margin-bottom: 20px;
  }

  table {
    border-collapse: collapse;
    font-family: monospace, monospace;
  }

  code {
    font-family: monospace, monospace;
  }

  th {
    font-weight: 600;
  }

  td, th {
    text-align: left;
    padding: 10px;
    border: 1px solid #999;
  }

  .breadcrumb {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    align-items: baseline;
    padding-left: 0;
  }

  .breadcrumb li {
    display: inline;
    white-space: nowrap;
  }

  .breadcrumb li + li:before {
    content: ">";
    padding: 0.25rem;
  }

  /* Sidenote layout. */

  @media (min-width: 921px) {
    .content {
        box-sizing: border-box;
        max-width: unset;
        width: 920px;
        display: grid;
        grid-template-columns: 600px 300px;
        column-gap: 20px;
        row-gap: 20px;
        justify-items: stretch;
        align-items: start;
    }
    
    .content > :not(.small) {
        box-sizing: border-box;
        width: 600px;
        margin-top: 0;
        margin-bottom: 0;
        grid-column-start: 1;
    }
    
    .content > .small {
        box-sizing: border-box;
        width: 300px;
        grid-column-start: 2;
        margin-top: 0;
        margin-bottom: 0;

        font-size: smaller;
    }
  }

  sup {
    line-height: 0;
  }
  </style>
  <style type="text/css">
        tr.sheets td {
    background-color: rgb(238, 241, 242);
  }

  tr span.blk,
  tr span.red,
  tr span.org,
  tr span.ylw,
  tr span.grn,
  tr span.cyn,
  tr span.blu,
  tr span.prp,
  tr span.mag {
    text-decoration: underline;
    text-decoration-thickness: 0.15em;
  }

  tr.blk th {
    background-color: rgb(0, 0, 0);
    color: white;
  }

  tr span.blk {
    text-decoration-color: rgb(0, 0, 0);
  }

  tr.red th {
    background-color: rgb(210, 7, 24);
    color: white;
  }

  tr span.red {
    text-decoration-color: rgb(210, 7, 24);
  }

  tr.org th {
    background-color: rgb(238, 132, 63);
  }

  tr span.org {
    text-decoration-color: rgb(238, 132, 63);
  }

  tr.ylw th {
    background-color: rgb(249, 183, 66);
  }

  tr span.ylw {
    text-decoration-color: rgb(249, 183, 66);
  }

  tr.grn th {
    background-color: rgb(90, 155, 76);
  }

  tr span.grn {
    text-decoration-color: rgb(90, 155, 76);
  }

  tr.cyn th {
    background-color: rgb(46, 118, 129);
    color: white;
  }

  tr span.cyn {
    text-decoration-color: rgb(46, 118, 129);
  }

  tr.blu th {
    background-color: rgb(0, 114, 205);
    color: white;
  }

  tr span.blu {
    text-decoration-color: rgb(0, 114, 205);
  }

  tr.prp th {
    background-color: rgb(88, 74, 153);
    color: white;
  }

  tr span.prp {
    text-decoration-color: rgb(88, 74, 152);
  }

  tr.mag th {
    background-color: rgb(163, 70, 109);
    color: white;
  }

  tr span.mag {
    text-decoration-color: rgb(163, 70, 109);
  }

  </style>
</head>
<body>
  <div class="content">
    <ol class="breadcrumb">
      <li>
        <a href="../index.html">Mathias Kools</a>
      </li>
      <li>
        <a href="../aoc2021.html">Advent of Code 2021 in
        Spreadsheets</a>
      </li>
      <li class="active">
        <a href="../aoc2021/1.html">AOC Day 1 2021</a>
      </li>
    </ol>
    <h1><a href="https://adventofcode.com/2021/day/1">AOC Day 1</a>
    2021</h1>
    <p>This is part of a greater series about <a href=
    "../aoc2021.html">solving advent of code with
    spreadsheets</a>.</p>
    <nav id="TableOfContents">
      <ul>
        <li>
          <a href="#part-one">Part One</a>
          <ul>
            <li>
              <a href="#solving-part-one">Solving Part One</a>
            </li>
            <li>
              <a href="#how-part-one-works">How Part One Works</a>
              <ul>
                <li>
                  <a href="#about-the-colors">About the Colors</a>
                </li>
                <li>
                  <a href="#repeat">Repeat</a>
                </li>
                <li>
                  <a href=
                  "#transposing-rows-and-columns">Transposing Rows
                  and Columns</a>
                  <ul>
                    <li>
                      <a href="#boolean-values">Boolean Values</a>
                    </li>
                    <li>
                      <a href="#formulas-on-ranges">Formulas on
                      Ranges</a>
                    </li>
                  </ul>
                </li>
                <li>
                  <a href="#putting-it-all-together">Putting It All
                  Together</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          <a href="#part-two">Part Two</a>
          <ul>
            <li>
              <a href="#solving-part-two">Solving Part Two</a>
            </li>
          </ul>
        </li>
      </ul>
    </nav>
    <h2 id="part-one">Part One</h2>
    <p>Read part one from the advent of code website.<sup>0</sup>
    The input is a line-separated list of numbers. The goal is to
    count how many numbers are greater than the previous one.</p>
    <div class="small">
      (0) This is the easiest way for me to navigate <a href=
      "https://www.reddit.com/r/adventofcode/comments/e4mkjq/comment/f9dy1e7/?utm_source=share&amp;utm_medium=web2x&amp;context=3">
      Advent of Code copyright</a>.
    </div>
    <h3 id="solving-part-one">Solving Part One</h3>
    <p>This challenge was easy with spreadsheets.<sup>1</sup></p>
    <div class="small">
      (1) This was a confidence I came to regret.
    </div>
    <table>
      <tbody>
        <tr class="blk A">
          <th>DATA</th>
          <td>A2</td>
          <td>A3</td>
          <td>...</td>
        </tr>
        <tr class="red B">
          <th>INCREASE</th>
          <td>-</td>
          <td>B3 = <span class="blk">A3 &gt; A2</span></td>
          <td>repeat →</td>
        </tr>
        <tr class="C">
          <th>OUTPUT</th>
          <td>C3 =<br>
          COUNTIF(<span class="red">B3:B</span>,"=TRUE")</td>
          <td></td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <p>I’ve omitted row numbers and columns and just done them
    inline. I think this format is more readable.</p>
    <p>This solution scaled well to the challenge input of
    <strong>2000 lines</strong>.</p>
    <h3 id="how-part-one-works">How Part One Works</h3>
    <p>The first spreadsheet of this series is worth explaining in
    full detail.</p>
    <h4 id="about-the-colors">About the Colors</h4>
    <p>Generally, each column is like a “stage” of the program.
    Some stages rely on previous ones. To make these connections
    clear, columns and their formula references are
    colored<sup>2</sup>.</p>
    <div class="small">
      (2) The colors themselves come from Google Sheets. I ripped
      them using <a href="https://superuser.com/a/372919">OSX’s
      Digital Color Meter</a>.
    </div>
    <h4 id="repeat">Repeat</h4>
    <p>Formulas reference other cells by column (named with a
    letter A-Z), and by row (a number 1-2000). To copy formulas to
    other cells the user “drags”<sup>3</sup> that cell over the row
    or column. When copied like this the cell formula updates to
    keep the same “relative” references.</p>
    <div class="small">
      (3) Power users know to double click instead of drag. This
      will copy the formula to the entire column as long as there’s
      data to the left. This series forced me to learn.
    </div>
    <p>For example …</p>
    <ul>
      <li>If a formula uses the cell to its left <code>= A2 +
      1</code></li>
      <li>The formula “dragged” to the next row will also use the
      cell to the left <code>= A3 + 1</code></li>
      <li>The formula “dragged” to the next column still uses the
      cell to the left <code>= B3 + 1</code></li>
    </ul>
    <table>
      <tbody>
        <tr>
          <td></td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr class="blk A">
          <td>A</td>
          <th>DATA</th>
          <td>199</td>
          <td>399</td>
        </tr>
        <tr class="red B">
          <td>B</td>
          <th>HEADER</th>
          <td>B2 = <span class="blk">A2</span>+1 =&gt;<br>
          200+1 =&gt;<br>
          201</td>
          <td>B3 = <span class="blk">A3</span>+1 =&gt;<br>
          399+1 =&gt;<br>
          400</td>
        </tr>
        <tr class="ylw C">
          <td>C</td>
          <th>HEADER</th>
          <td>C2 = <span class="red">B2</span>+1 =&gt;<br>
          201+1 =&gt;<br>
          202</td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <p>There is a way to instruct Google Sheets to keep a part of
    the cell reference absolute <code>$</code>. This isn’t used in
    this example.</p>
    <h4 id="transposing-rows-and-columns">Transposing Rows and
    Columns</h4>
    <p>Data is often pasted into thousands of rows. This isn’t as
    interesting as the formulas unique to each column.
    Additionally, with many columns the table can get quite wide.
    For these reasons I format tables with columns running along
    the top to bottom axis. Rows run from the left to right.</p>
    <p>For example, a table looking like this in Google Sheets
    …</p>
    <table>
      <tbody>
        <tr>
          <td></td>
          <td>A</td>
          <td>B</td>
          <td>C</td>
          <td>...</td>
        </tr>
        <tr>
          <td>1</td>
          <th>HEADER1</th>
          <th>HEADER2</th>
          <th>HEADER3</th>
          <td>...</td>
        </tr>
        <tr>
          <td>2</td>
          <td>A2</td>
          <td>B2</td>
          <td>C2</td>
          <td>...</td>
        </tr>
        <tr>
          <td>3</td>
          <td>A3</td>
          <td>B3</td>
          <td>C3</td>
          <td>...</td>
        </tr>
        <tr>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
      </tbody>
    </table>
    <p>Will look like this in this series …</p>
    <table>
      <tbody>
        <tr>
          <td></td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>...</td>
        </tr>
        <tr>
          <td>A</td>
          <th>HEADER1</th>
          <td>A2</td>
          <td>A3</td>
          <td>...</td>
        </tr>
        <tr>
          <td>B</td>
          <th>HEADER2</th>
          <td>B2</td>
          <td>B3</td>
          <td>...</td>
        </tr>
        <tr>
          <td>C</td>
          <th>HEADER3</th>
          <td>C2</td>
          <td>C3</td>
          <td>...</td>
        </tr>
        <tr>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
      </tbody>
    </table>
    <h5 id="boolean-values">Boolean Values</h5>
    <p>Cells can have non-numeric data types<sup>4</sup>. My advent
    of code solutions rely mostly on numbers and booleans.</p>
    <div class="small">
      (4) <a href=
      "https://www.theverge.com/2020/8/6/21355674/human-genes-rename-microsoft-excel-misreading-dates">
      Types are finicky</a>.
    </div>
    <p>Operators like <code>&gt;</code>, <code>&lt;</code>, and
    <code>=</code><sup>5</sup> produce booleans. In the
    <code>INCREASE</code> column I use <code>&gt;</code> to compare
    the current number to the previous number.</p>
    <div class="small">
      (5) Only one equal sign! It is not <code>==</code> like in a
      lot of programming languages.
    </div>
    <h5 id="formulas-on-ranges">Formulas on Ranges</h5>
    <p>Cell ranges are continuous blocks of cells. To reference
    …</p>
    <ul>
      <li>The first four cells of column <code>A</code>, use
      <code>A1:A4</code><sup>6</sup>.</li>
      <li>The range starting at cell <code>A4</code> and going
      until the end of the column, use <code>A4:A</code>.</li>
    </ul>
    <div class="small">
      (6) Cell ranges are <em>inclusive</em>.
    </div>
    <p>Some spreadsheet functions can act on cell ranges.
    <code>COUNTIF</code> counts the number of items in a range
    matching a “criterion”. Some example string criteria are …</p>
    <ul>
      <li>“=TRUE” for checking if a cell equals TRUE.</li>
      <li>“&gt;=4” for checking if a cell is greater than or equal
      to 4.</li>
    </ul>
    <h4 id="putting-it-all-together">Putting It All Together</h4>
    <ul>
      <li>Paste the input into the first column
      (<code>DATA</code>).</li>
      <li>The second column computes if the current number is
      greater than the previous one <code>A3 &gt; A2</code>.</li>
      <li>The third column uses a single cell counting the matches
      in the second column.</li>
    </ul>
    <h2 id="part-two">Part Two</h2>
    <p>Part two asks<sup>7</sup> to count the number of 3-wide
    sliding windows with a sum greater than the previous one.</p>
    <div class="small">
      (7) Part two isn’t readable from the website until you do
      part one.
    </div>
    <p>To understand 3-wide sliding windows think …</p>
    <ul>
      <li>Ruby Enumerable’s <a href=
      "https://ruby-doc.org/core-2.5.1/Enumerable.html#method-i-each_cons">
        each_cons(3)</a>.
      </li>
      <li>Python itertool’s <a href=
      "https://docs.python.org/3/library/itertools.html#itertools.pairwise">
        pairwise</a> except for triples.
      </li>
      <li>Implemented as <a href=
      "https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.triplewise">
        triplewise in more_itertools</a>.
      </li>
    </ul>
    <h3 id="solving-part-two">Solving Part Two</h3>
    <p>This requires one extra column.</p>
    <table>
      <tbody>
        <tr class="red A">
          <th>DATA</th>
          <td>A2</td>
          <td>A3</td>
          <td>A4</td>
          <td>A5</td>
          <td>...</td>
        </tr>
        <tr class="ylw B">
          <th>3SUM<sup>8</sup></th>
          <td>-</td>
          <td>-</td>
          <td>B4 =<br>
          <span class="blk">A2+A3+A4</span></td>
          <td>B5 =<br>
          <span class="blk">A3+A4+A5</span></td>
          <td>repeat →</td>
        </tr>
        <tr class="cyn C">
          <th>INCREASE</th>
          <td>-</td>
          <td>-</td>
          <td>-</td>
          <td>C5 =<br>
          <span class="red">B5 &gt; B4</span></td>
          <td>repeat →</td>
        </tr>
        <tr>
          <th>OUTPUT</th>
          <td>D2 =<br>
          COUNTIF(<span class="cyn">C5:C</span>)</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
        </tr>
      </tbody>
    </table>
    <div class="small">
      (8) You can simplify away the <code>3SUM</code> column. Do
      the sum inline in the <code>INCREASE</code> column <code>A3 +
      A4 + A5 &gt; A2 + A3 + A4</code>.
    </div>
    <p>You may be interested in the <a href=
    "../aoc2021/2.html">next</a> day's solution.</p>
  </div>
</body>
</html>
